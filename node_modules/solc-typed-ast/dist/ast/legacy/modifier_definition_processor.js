"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.LegacyModifierDefinitionProcessor = void 0;
const override_specifier_1 = require("../implementation/meta/override_specifier");
const structured_documentation_1 = require("../implementation/meta/structured_documentation");
const node_processor_1 = require("./node_processor");
class LegacyModifierDefinitionProcessor extends node_processor_1.LegacyNodeProcessor {
    process(reader, config, raw) {
        const [id, src] = super.process(reader, config, raw);
        const attributes = raw.attributes;
        const children = reader.convertArray(raw.children, config);
        const name = attributes.name;
        const visibility = attributes.visibility;
        const virtual = "virtual" in attributes ? attributes.virtual : false;
        const [structuredDocumentation, overrideSpecifier, parameters, body] = this.extract(children);
        let documentation;
        if (structuredDocumentation) {
            documentation = structuredDocumentation;
        }
        else if (typeof attributes.documentation === "string") {
            documentation = attributes.documentation;
        }
        return [
            id,
            src,
            name,
            virtual,
            visibility,
            parameters,
            overrideSpecifier,
            body,
            documentation,
            undefined,
            raw
        ];
    }
    extract(children) {
        let node = children.shift();
        let documentation;
        if (node instanceof structured_documentation_1.StructuredDocumentation) {
            documentation = node;
            node = children.shift();
        }
        const parameters = node;
        node = children.shift();
        let overrideSpecifier;
        if (node instanceof override_specifier_1.OverrideSpecifier) {
            overrideSpecifier = node;
            node = children.shift();
        }
        const body = node;
        return [documentation, overrideSpecifier, parameters, body];
    }
}
exports.LegacyModifierDefinitionProcessor = LegacyModifierDefinitionProcessor;
//# sourceMappingURL=modifier_definition_processor.js.map