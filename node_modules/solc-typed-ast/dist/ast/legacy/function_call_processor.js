"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.LegacyFunctionCallProcessor = void 0;
const constants_1 = require("../constants");
const expression_processor_1 = require("./expression_processor");
class LegacyFunctionCallProcessor extends expression_processor_1.LegacyExpressionProcessor {
    process(reader, config, raw) {
        const [id, src, typeString] = super.process(reader, config, raw);
        const attributes = raw.attributes;
        const kind = this.detectKind(attributes);
        const fieldNames = this.detectFieldNames(attributes);
        const [expression, ...args] = reader.convertArray(raw.children, config);
        return [id, src, typeString, kind, expression, args, fieldNames, raw];
    }
    detectKind(attributes) {
        if (attributes.type_conversion) {
            return constants_1.FunctionCallKind.TypeConversion;
        }
        if (attributes.isStructConstructorCall) {
            return constants_1.FunctionCallKind.StructConstructorCall;
        }
        return constants_1.FunctionCallKind.FunctionCall;
    }
    detectFieldNames(attributes) {
        const names = attributes.names;
        return names.length && !(names.length === 1 && names[0] === null) ? names : undefined;
    }
}
exports.LegacyFunctionCallProcessor = LegacyFunctionCallProcessor;
//# sourceMappingURL=function_call_processor.js.map